INFO:root:Namespace(model_name='fuxi', model_mode='')
INFO:root:--------------------------------------------- BEGIN: 2025-11-30 17:13:05 ---------------------------------------------
INFO:root:
===============================================
 Arguments              | Values               
===============================================
 batch_size             | 128                 
 data_appendix          |                     
 dataset                | Grocery_and_Gourm...
 dropout                | 0.2                 
 early_stop             | 0                   
 emb_size               | 50                  
 epoch                  | 101                 
 eval_batch_size        | 128                 
 fuxi_attention_dim     | 50                  
 fuxi_attn_dropout      | 0.2                 
 fuxi_blocks            | 2                   
 fuxi_enable_rel_bias   | 1                   
 fuxi_ffn_multiply      | 1.0                 
 fuxi_ffn_single_stage  | 0                   
 fuxi_heads             | 1                   
 fuxi_linear_activation | silu                
 fuxi_linear_dim        | 50                  
 fuxi_linear_dropout    | 0.2                 
 gpu                    | 0                   
 history_max            | 200                 
 l2                     | 0.0                 
 lr                     | 0.001               
 main_metric            |                     
 num_neg                | 128                 
 num_workers            | 5                   
 optimizer              | Adam                
 random_seed            | 0                   
 save_final_results     | 0                   
 test_all               | 0                   
 topk                   | 5,10,20,50          
===============================================
INFO:root:Device: cuda
INFO:root:Load corpus from data/Grocery_and_Gourmet_Food/SeqReader.pkl
INFO:root:#params: 506960
INFO:root:FuXi(
  (embedding_module): LocalEmbeddingModule(
    (_item_emb): Embedding(8715, 50, padding_idx=0)
  )
  (interaction_module): DotProductSimilarity()
  (input_preproc): LearnablePositionalEmbeddingInputFeaturesPreprocessor(
    (_pos_emb): Embedding(201, 50)
    (_emb_dropout): Dropout(p=0.2, inplace=False)
  )
  (output_postproc): L2NormEmbeddingPostprocessor()
  (encoder): FuXi(
    (_ndp_module): DotProductSimilarity()
    (_embedding_module): LocalEmbeddingModule(
      (_item_emb): Embedding(8715, 50, padding_idx=0)
    )
    (_input_features_preproc): LearnablePositionalEmbeddingInputFeaturesPreprocessor(
      (_pos_emb): Embedding(201, 50)
      (_emb_dropout): Dropout(p=0.2, inplace=False)
    )
    (_output_postproc): L2NormEmbeddingPostprocessor()
    (_fuxi): FuXiJagged(
      (_attention_layers): ModuleList(
        (0-1): 2 x FuXiBlockJagged(
          (_rel_attn_bias): SeperatedRelativeBucketedTimeAndPositionBasedBias()
          (_mffn): MultistageFeedforwardNeuralNetwork(
            (lin0): Linear(in_features=150, out_features=50, bias=True)
            (lin1): Linear(in_features=50, out_features=50, bias=False)
            (lin2): Linear(in_features=50, out_features=50, bias=False)
            (lin3): Linear(in_features=50, out_features=50, bias=False)
          )
        )
      )
    )
  )
)
INFO:root:Test Before Training: (HR@5:0.0486,NDCG@5:0.0285,HR@10:0.0988,NDCG@10:0.0446,HR@20:0.1943,NDCG@20:0.0684,HR@50:0.4984,NDCG@50:0.1277)
INFO:root:Optimizer: Adam
INFO:root:Epoch 1     loss=0.5932 [36.2 s]	dev=(HR@5:0.2855,NDCG@5:0.1918) [1.7 s] *
INFO:root:Epoch 2     loss=0.5134 [37.7 s]	dev=(HR@5:0.3484,NDCG@5:0.2369) [1.6 s] *
INFO:root:Epoch 3     loss=0.4879 [37.3 s]	dev=(HR@5:0.3717,NDCG@5:0.2569) [1.6 s] *
INFO:root:Epoch 4     loss=0.4686 [37.6 s]	dev=(HR@5:0.3900,NDCG@5:0.2753) [1.9 s] *
INFO:root:Epoch 5     loss=0.4509 [37.7 s]	dev=(HR@5:0.4032,NDCG@5:0.2929) [1.9 s] *
INFO:root:Epoch 6     loss=0.4343 [38.3 s]	dev=(HR@5:0.4144,NDCG@5:0.3049) [1.8 s] *
INFO:root:Epoch 7     loss=0.4198 [38.2 s]	dev=(HR@5:0.4204,NDCG@5:0.3135) [1.7 s] *
INFO:root:Epoch 8     loss=0.4064 [37.5 s]	dev=(HR@5:0.4234,NDCG@5:0.3192) [0.0 s] *
INFO:root:Epoch 9     loss=0.3947 [37.8 s]	dev=(HR@5:0.4363,NDCG@5:0.3301) [1.6 s] *
INFO:root:Epoch 10    loss=0.3840 [38.2 s]	dev=(HR@5:0.4375,NDCG@5:0.3337) [1.7 s] *
INFO:root:Epoch 11    loss=0.3747 [37.5 s]	dev=(HR@5:0.4389,NDCG@5:0.3362) [1.6 s] *
INFO:root:Epoch 12    loss=0.3660 [37.9 s]	dev=(HR@5:0.4409,NDCG@5:0.3393) [0.1 s] *
INFO:root:Epoch 13    loss=0.3587 [39.6 s]	dev=(HR@5:0.4418,NDCG@5:0.3398) [1.8 s] *
INFO:root:Epoch 14    loss=0.3516 [37.6 s]	dev=(HR@5:0.4419,NDCG@5:0.3421) [1.8 s] *
INFO:root:Epoch 15    loss=0.3457 [38.5 s]	dev=(HR@5:0.4416,NDCG@5:0.3433) [1.8 s] *
INFO:root:Epoch 16    loss=0.3399 [37.0 s]	dev=(HR@5:0.4435,NDCG@5:0.3441) [1.8 s] *
INFO:root:Epoch 17    loss=0.3345 [37.7 s]	dev=(HR@5:0.4439,NDCG@5:0.3459) [1.8 s] *
INFO:root:Epoch 18    loss=0.3291 [38.2 s]	dev=(HR@5:0.4448,NDCG@5:0.3469) [1.7 s] *
INFO:root:Epoch 19    loss=0.3244 [39.3 s]	dev=(HR@5:0.4450,NDCG@5:0.3468) [1.8 s]
INFO:root:Epoch 20    loss=0.3201 [36.9 s]	dev=(HR@5:0.4445,NDCG@5:0.3453) [1.9 s]
INFO:root:Epoch 21    loss=0.3161 [40.0 s]	dev=(HR@5:0.4477,NDCG@5:0.3488) [1.7 s] *
INFO:root:Epoch 22    loss=0.3118 [38.5 s]	dev=(HR@5:0.4435,NDCG@5:0.3468) [1.7 s]
INFO:root:Epoch 23    loss=0.3078 [38.2 s]	dev=(HR@5:0.4438,NDCG@5:0.3465) [0.0 s]
INFO:root:Epoch 24    loss=0.3039 [39.6 s]	dev=(HR@5:0.4433,NDCG@5:0.3465) [1.9 s]
INFO:root:Epoch 25    loss=0.3005 [39.8 s]	dev=(HR@5:0.4434,NDCG@5:0.3474) [1.7 s]
INFO:root:Epoch 26    loss=0.2970 [39.3 s]	dev=(HR@5:0.4443,NDCG@5:0.3470) [1.8 s]
INFO:root:Epoch 27    loss=0.2936 [37.3 s]	dev=(HR@5:0.4422,NDCG@5:0.3459) [1.7 s]
INFO:root:Epoch 28    loss=0.2906 [37.6 s]	dev=(HR@5:0.4430,NDCG@5:0.3473) [1.8 s]
INFO:root:Epoch 29    loss=0.2875 [38.2 s]	dev=(HR@5:0.4393,NDCG@5:0.3460) [1.8 s]
INFO:root:Epoch 30    loss=0.2849 [37.8 s]	dev=(HR@5:0.4397,NDCG@5:0.3460) [2.0 s]
INFO:root:Epoch 31    loss=0.2813 [39.7 s]	dev=(HR@5:0.4442,NDCG@5:0.3496) [1.9 s] *
INFO:root:Epoch 32    loss=0.2787 [39.5 s]	dev=(HR@5:0.4398,NDCG@5:0.3455) [1.9 s]
INFO:root:Epoch 33    loss=0.2761 [39.1 s]	dev=(HR@5:0.4394,NDCG@5:0.3463) [2.0 s]
INFO:root:Epoch 34    loss=0.2734 [36.8 s]	dev=(HR@5:0.4393,NDCG@5:0.3468) [1.7 s]
INFO:root:Epoch 35    loss=0.2709 [39.3 s]	dev=(HR@5:0.4385,NDCG@5:0.3457) [1.7 s]
INFO:root:Epoch 36    loss=0.2683 [39.3 s]	dev=(HR@5:0.4391,NDCG@5:0.3459) [1.8 s]
INFO:root:Epoch 37    loss=0.2663 [37.6 s]	dev=(HR@5:0.4391,NDCG@5:0.3456) [2.0 s]
INFO:root:Epoch 38    loss=0.2638 [52.0 s]	dev=(HR@5:0.4355,NDCG@5:0.3435) [1.8 s]
INFO:root:Epoch 39    loss=0.2612 [36.4 s]	dev=(HR@5:0.4374,NDCG@5:0.3453) [1.7 s]
INFO:root:Epoch 40    loss=0.2592 [40.7 s]	dev=(HR@5:0.4376,NDCG@5:0.3468) [2.0 s]
INFO:root:Epoch 41    loss=0.2576 [40.3 s]	dev=(HR@5:0.4366,NDCG@5:0.3449) [45.5 s]
INFO:root:Epoch 42    loss=0.2551 [39.8 s]	dev=(HR@5:0.4380,NDCG@5:0.3457) [1.8 s]
INFO:root:Epoch 43    loss=0.2530 [40.1 s]	dev=(HR@5:0.4357,NDCG@5:0.3439) [1.8 s]
INFO:root:Epoch 44    loss=0.2512 [37.8 s]	dev=(HR@5:0.4372,NDCG@5:0.3457) [1.9 s]
INFO:root:Epoch 45    loss=0.2495 [40.1 s]	dev=(HR@5:0.4383,NDCG@5:0.3467) [1.8 s]
INFO:root:Epoch 46    loss=0.2471 [40.0 s]	dev=(HR@5:0.4382,NDCG@5:0.3458) [1.9 s]
INFO:root:Epoch 47    loss=0.2456 [38.0 s]	dev=(HR@5:0.4367,NDCG@5:0.3459) [2.0 s]
INFO:root:Epoch 48    loss=0.2435 [39.1 s]	dev=(HR@5:0.4383,NDCG@5:0.3462) [1.8 s]
INFO:root:Epoch 49    loss=0.2421 [39.8 s]	dev=(HR@5:0.4361,NDCG@5:0.3442) [1.8 s]
INFO:root:Epoch 50    loss=0.2403 [40.5 s]	dev=(HR@5:0.4323,NDCG@5:0.3421) [0.4 s]
INFO:root:Epoch 51    loss=0.2388 [41.3 s]	dev=(HR@5:0.4360,NDCG@5:0.3453) [2.0 s]
INFO:root:Epoch 52    loss=0.2368 [40.0 s]	dev=(HR@5:0.4331,NDCG@5:0.3437) [1.9 s]
INFO:root:Epoch 53    loss=0.2357 [40.8 s]	dev=(HR@5:0.4332,NDCG@5:0.3441) [-0.0 s]
INFO:root:Epoch 54    loss=0.2341 [40.9 s]	dev=(HR@5:0.4337,NDCG@5:0.3437) [1.8 s]
INFO:root:Epoch 55    loss=0.2327 [40.2 s]	dev=(HR@5:0.4336,NDCG@5:0.3433) [1.7 s]
INFO:root:Epoch 56    loss=0.2312 [38.9 s]	dev=(HR@5:0.4318,NDCG@5:0.3423) [1.6 s]
INFO:root:Epoch 57    loss=0.2296 [36.6 s]	dev=(HR@5:0.4331,NDCG@5:0.3437) [1.7 s]
INFO:root:Epoch 58    loss=0.2284 [38.7 s]	dev=(HR@5:0.4314,NDCG@5:0.3422) [1.8 s]
INFO:root:Epoch 59    loss=0.2271 [38.9 s]	dev=(HR@5:0.4313,NDCG@5:0.3420) [1.7 s]
INFO:root:Epoch 60    loss=0.2262 [37.1 s]	dev=(HR@5:0.4295,NDCG@5:0.3416) [1.6 s]
INFO:root:Epoch 61    loss=0.2252 [38.8 s]	dev=(HR@5:0.4313,NDCG@5:0.3418) [1.7 s]
INFO:root:Epoch 62    loss=0.2233 [39.1 s]	dev=(HR@5:0.4293,NDCG@5:0.3403) [1.7 s]
INFO:root:Epoch 63    loss=0.2219 [39.3 s]	dev=(HR@5:0.4322,NDCG@5:0.3429) [1.9 s]
INFO:root:Epoch 64    loss=0.2210 [38.0 s]	dev=(HR@5:0.4279,NDCG@5:0.3388) [1.9 s]
INFO:root:Epoch 65    loss=0.2201 [40.2 s]	dev=(HR@5:0.4276,NDCG@5:0.3394) [1.8 s]
INFO:root:Epoch 66    loss=0.2192 [40.0 s]	dev=(HR@5:0.4301,NDCG@5:0.3416) [1.7 s]
INFO:root:Epoch 67    loss=0.2179 [38.0 s]	dev=(HR@5:0.4265,NDCG@5:0.3392) [1.9 s]
INFO:root:Epoch 68    loss=0.2172 [39.8 s]	dev=(HR@5:0.4262,NDCG@5:0.3379) [2.1 s]
INFO:root:Epoch 69    loss=0.2157 [40.8 s]	dev=(HR@5:0.4269,NDCG@5:0.3391) [1.8 s]
INFO:root:Epoch 70    loss=0.2148 [37.9 s]	dev=(HR@5:0.4288,NDCG@5:0.3409) [1.8 s]
INFO:root:Epoch 71    loss=0.2142 [41.2 s]	dev=(HR@5:0.4271,NDCG@5:0.3394) [2.0 s]
INFO:root:Epoch 72    loss=0.2128 [41.4 s]	dev=(HR@5:0.4279,NDCG@5:0.3401) [1.8 s]
INFO:root:Epoch 73    loss=0.2115 [37.7 s]	dev=(HR@5:0.4274,NDCG@5:0.3400) [1.7 s]
INFO:root:Epoch 74    loss=0.2111 [39.9 s]	dev=(HR@5:0.4276,NDCG@5:0.3398) [1.8 s]
INFO:root:Epoch 75    loss=0.2100 [39.4 s]	dev=(HR@5:0.4266,NDCG@5:0.3398) [1.8 s]
INFO:root:Epoch 76    loss=0.2094 [37.9 s]	dev=(HR@5:0.4237,NDCG@5:0.3371) [1.7 s]
INFO:root:Epoch 77    loss=0.2083 [40.5 s]	dev=(HR@5:0.4269,NDCG@5:0.3398) [1.7 s]
INFO:root:Epoch 78    loss=0.2077 [40.2 s]	dev=(HR@5:0.4254,NDCG@5:0.3384) [2.1 s]
INFO:root:Epoch 79    loss=0.2066 [38.4 s]	dev=(HR@5:0.4270,NDCG@5:0.3398) [1.9 s]
INFO:root:Epoch 80    loss=0.2058 [39.4 s]	dev=(HR@5:0.4254,NDCG@5:0.3384) [1.9 s]
INFO:root:Epoch 81    loss=0.2052 [40.4 s]	dev=(HR@5:0.4253,NDCG@5:0.3379) [2.0 s]
INFO:root:Epoch 82    loss=0.2047 [40.6 s]	dev=(HR@5:0.4239,NDCG@5:0.3366) [1.9 s]
INFO:root:Epoch 83    loss=0.2045 [40.2 s]	dev=(HR@5:0.4259,NDCG@5:0.3373) [1.7 s]
INFO:root:Epoch 84    loss=0.2035 [40.2 s]	dev=(HR@5:0.4200,NDCG@5:0.3343) [1.7 s]
INFO:root:Epoch 85    loss=0.2024 [38.2 s]	dev=(HR@5:0.4248,NDCG@5:0.3365) [2.0 s]
INFO:root:Epoch 86    loss=0.2016 [39.7 s]	dev=(HR@5:0.4233,NDCG@5:0.3360) [1.9 s]
INFO:root:Epoch 87    loss=0.2010 [38.7 s]	dev=(HR@5:0.4261,NDCG@5:0.3380) [1.7 s]
INFO:root:Epoch 88    loss=0.2007 [37.2 s]	dev=(HR@5:0.4223,NDCG@5:0.3356) [1.7 s]
INFO:root:Epoch 89    loss=0.2000 [39.5 s]	dev=(HR@5:0.4209,NDCG@5:0.3352) [2.2 s]
INFO:root:Epoch 90    loss=0.1995 [40.5 s]	dev=(HR@5:0.4233,NDCG@5:0.3366) [1.9 s]
INFO:root:Epoch 91    loss=0.1986 [39.5 s]	dev=(HR@5:0.4227,NDCG@5:0.3349) [-0.0 s]
INFO:root:Epoch 92    loss=0.1980 [40.6 s]	dev=(HR@5:0.4228,NDCG@5:0.3355) [1.9 s]
INFO:root:Epoch 93    loss=0.1972 [38.8 s]	dev=(HR@5:0.4236,NDCG@5:0.3359) [1.7 s]
INFO:root:Epoch 94    loss=0.1969 [38.8 s]	dev=(HR@5:0.4203,NDCG@5:0.3338) [1.7 s]
INFO:root:Epoch 95    loss=0.1967 [39.0 s]	dev=(HR@5:0.4198,NDCG@5:0.3339) [1.8 s]
INFO:root:Epoch 96    loss=0.1959 [37.4 s]	dev=(HR@5:0.4213,NDCG@5:0.3345) [1.8 s]
INFO:root:Epoch 97    loss=0.1953 [39.2 s]	dev=(HR@5:0.4204,NDCG@5:0.3345) [1.8 s]
INFO:root:Epoch 98    loss=0.1946 [39.1 s]	dev=(HR@5:0.4219,NDCG@5:0.3351) [1.8 s]
INFO:root:Epoch 99    loss=0.1944 [37.5 s]	dev=(HR@5:0.4208,NDCG@5:0.3346) [1.8 s]
INFO:root:Epoch 100   loss=0.1940 [39.1 s]	dev=(HR@5:0.4187,NDCG@5:0.3341) [1.8 s]
INFO:root:Epoch 101   loss=0.1933 [39.6 s]	dev=(HR@5:0.4168,NDCG@5:0.3317) [1.8 s]
INFO:root:
Best Iter(dev)=   31	 dev=(HR@5:0.4442,NDCG@5:0.3496) [4161.7 s] 
INFO:root:Load model from /mnt/e/collegeitem/third1/machinelearning/Fuxi-alpha-in-ReChorus/models_saved/fuxi_grocery_base.pt
INFO:root:
Dev  After Training: (HR@5:0.4442,NDCG@5:0.3496,HR@10:0.5297,NDCG@10:0.3771,HR@20:0.6372,NDCG@20:0.4042,HR@50:0.8215,NDCG@50:0.4407)
INFO:root:
Test After Training: (HR@5:0.4033,NDCG@5:0.3124,HR@10:0.4966,NDCG@10:0.3425,HR@20:0.6020,NDCG@20:0.3690,HR@50:0.8002,NDCG@50:0.4082)
INFO:root:
--------------------------------------------- END: 2025-11-30 18:22:36 ---------------------------------------------
